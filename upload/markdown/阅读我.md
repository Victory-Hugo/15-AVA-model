
## 中文版本

### 概述
AVA（本土起源 vs 混合起源）模型是一个综合分析管道，旨在基于遗传多样性模式、时间分布特征和单倍群独特性来评估和分类人群。该系统整合了多种统计方法来区分本土起源型、混合型和中间型人群。

### 管道架构
分析管道由四个主要组件按顺序执行：

1. **TMRCA统计分析** (`1-divergence_time_shape.py`)
2. **AMOVA多样性模式分析** (`2-AMOVA.py`)
3. **单倍群独特性分析** (`3-unique_haplogroup.py`)
4. **综合评分和分类** (`4-score.py`)

---

### 输入文件要求

#### 1. 主要数据集 (`data/ID_Name_Hap_Loc_LYC.csv`)
**必需列：**
- `Continent`: 样本的地理分类
- `Time_years`: TMRCA值（年）
- 其他所需人口统计学列

**格式：** 带标题的CSV文件
**用途：** TMRCA分布分析的主数据集

#### 2. AMOVA结果 (`data/AMOVA.csv`)
**必需列：**
- `Continent`: 地理分类
- `Source of variation`: 变异来源类型（必须包含"Within populations"）
- `Percentage of variation`: 数值百分比

**格式：** CSV/TSV（自动检测分隔符）
**用途：** 群体遗传多样性结构分析

#### 3. 公共单倍群数据集 (`data/public.csv`)
**必需列：**
- `ID`: 样本标识符
- `Continent`: 地理分类
- `Haplogroup`: 线粒体单倍群名称

**格式：** 带标题的CSV文件
**用途：** 单倍群频率和独特性分析

---

### 输出文件说明

#### 主要输出目录：`output/`

#### 1. TMRCA统计 (`Final_tmrca_stats.csv`)
**内容：** 按大陆划分的TMRCA分布统计摘要
**主要指标：**
- 时间分布特征（最大值、范围、标准差）
- 分布形状（偏度、峰数）
- 古老谱系比例

#### 2. AMOVA多样性评分 (`Final_AMOVA_scores.csv`)
**内容：** 群体内多样性模式
**评分范围：** 0-1，值越高表示多样性越高

#### 3. 单倍群独特性评分 (`Final_unique_hap.csv`)
**内容：** 各地区单倍群独特性指标
**评分范围：** 0-1，值越高表示独特性越强

#### 4. 最终综合评分 (`Final_metrics_scored.csv`)
**内容：** 综合评分和分类结果
**分类标准：**
- `Origin_like`: 评分 > 0.7（本土起源特征）
- `Middle_like`: 0.3 < 评分 ≤ 0.7（中间特征）
- `Mix_like`: 评分 ≤ 0.3（混合特征）

---

### 使用说明

#### 基本执行
```bash
cd /path/to/15-AVA-model/script/
bash 1-pipe.sh
```

#### 自定义参数
可通过修改`1-pipe.sh`中的参数来自定义管道：

**评分权重：**
- TMRCA相关权重：2.0
- 多样性权重：1.5
- 独特性权重：1.5

**分类阈值：**
- 本土起源阈值：0.7
- 混合起源阈值：0.3

---

### 结果解释指南

#### 评分解释
- **高分(>0.7)：** 提示本土起源特征
  - 高时间多样性
  - 低群体内遗传多样性
  - 独特的单倍群特征
  
- **中等分(0.3-0.7)：** 表示中间特征
  - 时间和遗传多样性平衡
  - 混合的单倍群模式

- **低分(<0.3)：** 提示混合特征
  - 有限的时间多样性
  - 高群体内遗传多样性
  - 常见/共享的单倍群模式

#### 注意事项
- 结果应结合考古学和历史证据进行解释
- 比较群体时应考虑样本量效应
- 地理和时间采样偏差可能影响结果

---

### 技术支持
如有问题或需要技术支持，请参考项目文档或联系开发团队。

---

**版本：** 1.0  
**更新日期：** 2025-09-29  
**作者：** AVA Model Development Team